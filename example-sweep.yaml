program: train.py
command:
  - python
  - ${program}
  - patch-ar
  - --config
  - ${args_json_file}
  - --dataset=sc09-mp3-downsampled
  - --num_epochs=500
  - --batch_size=64
  - --mins_per_checkpoint=60
  - --checkpoint_dir=gs://ssm-checkpoints/
method: grid
parameters:
  learning_rate:
    values:
      - 1e-4
      - 3e-4
      - 1e-3
      - 3e-3
  pool_temporal:
    values:
      - [2,2,2,2,2,2]
      - [8,1,1,8,1,1]
      - [16,1,1,4,1,1]
      - [4,1,1,16,1,1]
  learning_rate_scheduler:
    values:
      - "constant"
      - "warmup_cosine_decay"
  rnn.n_diag_blocks:
    values:
      - 1
      - 2
      - 4
      - 8
